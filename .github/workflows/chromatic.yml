name: Chromatic
on: push

jobs:
  chromatic:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - uses: actions/setup-node@v3
        with:
          node-version: 16
      - name: install
        run: yarn install --frozen-lockfile
      - name: run chromatic
        run: npx chromatic --only-changed --debug --trace-changed 'expanded' --exit-zero-on-changes --diagnostics --exit-once-uploaded --auto-accept-changes 'main'
        env:
          CHROMATIC_PROJECT_TOKEN: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
          STORYBOOK_GITHUB_SHA: ${{ github.event.pull_request.head.sha }}
      # - name: Run Chromatic
      #   id: run-chromatic-action
      #   uses: chromaui/action@v1
      #   with:
      #     onlyChanged: true
      #     traceChanged: true
      #     diagnostics: true
      #     exitZeroOnChanges: true
      #     exitOnceUploaded: true
      #     autoAcceptChanges: "main"
      #     skip: "test-chromatic"
      #   env:
      #     CHROMATIC_PROJECT_TOKEN: ${{ secrets.CHROMATIC_PROJECT_TOKEN }}
      #     STORYBOOK_GITHUB_SHA: ${{ github.event.pull_request.head.sha }}
